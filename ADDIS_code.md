---
title: "ADDIS_code"
author: "Lathan Liou"
date: "9/22/2020"
output: 
html_document:
  self_contained: no
---




 
<h2>ADDIS: Adaptive discarding algorithm for online FDR control</h2>  <h3>Description</h3>  <p>Implements the ADDIS algorithm for online FDR control, where ADDIS stands for an ADaptive algorithm that DIScards conservative nulls, as presented by Tian and Ramdas (2019). The algorithm compensates for the power loss of SAFFRON with conservative nulls, by including both adaptivity in the fraction of null hypotheses (like SAFFRON) and the conservativeness of nulls (unlike SAFFRON). </p>   <h3>Usage</h3>  <pre> ADDIS(d, alpha = 0.05, gammai, w0, lambda = 0.5, tau = 0.5, async = FALSE) </pre>   <h3>Arguments</h3>  <table summary="R argblock"> <tr valign="top"><td><code>d</code></td> <td> <p>Either a vector of p-values, or a dataframe with three columns: an identifier (&lsquo;id&rsquo;),  p-value (&lsquo;pval&rsquo;), and decision times  (&lsquo;decision.times&rsquo;).</p> </td></tr> <tr valign="top"><td><code>alpha</code></td> <td> <p>Overall significance level of the procedure, the default is 0.05.</p> </td></tr> <tr valign="top"><td><code>gammai</code></td> <td> <p>Optional vector of <i>&gamma;_i</i>. A default is provided with <i>&gamma;_j</i> proportional to <i>1/j^(1.6)</i>.</p> </td></tr> <tr valign="top"><td><code>w0</code></td> <td> <p>Initial &lsquo;wealth&rsquo; of the procedure, defaults to <i>&tau; &lambda; &alpha;/2</i>.</p> </td></tr> <tr valign="top"><td><code>lambda</code></td> <td> <p>Optional parameter that sets the threshold for &lsquo;candidate&rsquo; hypotheses. Must be between 0 and 1, defaults to 0.5.</p> </td></tr> <tr valign="top"><td><code>tau</code></td> <td> <p>Optional threshold for hypotheses to be selected for testing. Must be between 0 and 1, defaults to 0.5.</p> </td></tr> <tr valign="top"><td><code>async</code></td> <td> <p>Logical. If <code>TRUE</code> runs the version for an asynchronous testing process</p> </td></tr> </table>   <h3>Details</h3>  <p>The function takes as its input either a vector of p-values, or a dataframe with three columns: an identifier (&lsquo;id&rsquo;), p-value (&lsquo;pval&rsquo;), and decision times, if the asynchronous version is specified (see below).  Given an overall significance level <i>&alpha;</i>, ADDIS depends on constants <i>w_0</i> <i>&lambda;</i> and <i>&tau;</i>. <i>w_0</i> represents the intial &lsquo;wealth&rsquo; of the procedure and satisfies <i>0 &le; w_0 &le; &tau; &lambda; &alpha;</i>. <i>&tau; \in (0,1)</i> represents the threshold for a hypothesis to be selected for testing: p-values greater than <i>&tau;</i> are implicitly &lsquo;discarded&rsquo; by the procedure. Finally, <i>&lambda; \in (0,1)</i> sets the threshold for a p-value to be a candidate for rejection: ADDIS will never reject a p-value larger than <i>&tau; &lambda;</i>. The algorithm also require a sequence of non-negative non-increasing numbers <i>&gamma;_i</i> that sum to 1. </p> <p>The ADDIS procedure provably controls the FDR for independent p-values. Tian and Ramdas (2019) also presented a version for an asynchronous testing process, consisting of tests that start and finish at (potentially) random times. The discretised finish times of the test correspond to the decision times. These decision times are given as the input <code>decision.times</code>. </p> <p>Further details of the ADDIS algorithms can be found in Tian and Ramdas (2019). </p>   <h3>Value</h3>  <table summary="R valueblock"> <tr valign="top"><td><code>d.out</code></td> <td> <p>A dataframe with the original p-values <code>pval</code>, the adjusted testing levels <i>&alpha;_i</i> and the indicator function of discoveries <code>R</code>. Hypothesis <i>i</i> is rejected if the <i>i</i>-th p-value is less than or equal to <i>&alpha;_i</i>, in which case <code>R[i] =   1</code>  (otherwise <code>R[i] = 0</code>).</p> </td></tr> </table>   <h3>References</h3>  <p>Tian, J. and Ramdas, A. (2019). ADDIS: an adaptive discarding algorithm for online FDR control with conservative nulls. <em>arXiv preprint</em>, <a href="https://arxiv.org/abs/1905.11465">https://arxiv.org/abs/1905.11465</a>. </p>   <h3>See Also</h3>  <p>ADDIS is identical to <code>SAFFRON</code> with option <code>discard=TRUE</code>. </p> <p>ADDIS with option <code>async=TRUE</code> is identical to <code>SAFFRONstar</code> with option <code>discard=TRUE</code>. </p>   <h3>Examples</h3>  <pre> sample.df &lt;- data.frame( id = c('A15432', 'B90969', 'C18705', 'B49731', 'E99902',     'C38292', 'A30619', 'D46627', 'E29198', 'A41418',     'D51456', 'C88669', 'E03673', 'A63155', 'B66033'), pval = c(2.90e-08, 0.06743, 0.01514, 0.08174, 0.00171,         3.60e-05, 0.79149, 0.27201, 0.28295, 7.59e-08,         0.69274, 0.30443, 0.00136, 0.72342, 0.54757), decision.times = seq_len(15) + 1)  ADDIS(sample.df, async = TRUE) # Asynchronous  ADDIS(sample.df, async = FALSE) # Synchronous  </pre>   </body></html> 
